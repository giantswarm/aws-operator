version: 1
setup:
  - run: helm registry install quay.io/giantswarm/cert-operator-lab-chart -- --set imageTag=latest --set clusterName=my-cluster --wait
    waitFor:
      run: kubectl get certificate
      match: No resources found\.

  - run: helm registry install quay.io/giantswarm/cert-resource-lab-chart -- --set clusterName=my-cluster
    waitFor:
      run: kubectl get secrets
      match: my-cluster-api\s*Opaque

inClusterTest:
  enabled: true
